<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="CAD Services">
    <meta name="description" content="Professional CAD and land surveying services in Indore since 2000. Trusted by top builders and architects.">
    <meta property="image" content="https://www.cadservices.in/photos/cad-services.png" />
    <meta property="og:url" content="https://www.cadservices.in/" />
    <meta name="keywords" content="CAD services, land surveyor, land surveyor in indore, Indore survey, civil engineering, civil engineering in indore, topographic survey, topographic survey in indore, construction mapping, contour mapping in indore, layout work in indore, center line marking in indore, DGPS survey in indore, total station survey in indore, training program in indore, bridge survey in indore, road survey in indore, land development planning in indore, cad drafting in indore, cad services in indore, cad services near me, cad services for builders, cad services for architects, cad services for civil engineers">
    <meta name="robots" content="index, follow">
    <title>Cad Services | Admin-Panel</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="icon" type="image/x-icon" href="/photos/logo.png">
  <style>
    label {
      display: block;
      margin: 15px 0 5px;
      border-radius:3px;
    }
    input[type="text"], input[type="date"], input[type="file"],textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border-radius:3px;
      font-family: inherit;
      font-size: 1rem;
      resize: vertical;
    }
    #description,input[type="text"], input[type="date"] {
      border:2px solid black;
    }
    #editDescription, #editTitle, #editDate{
      border:2px solid black;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      width: 100%;
      background-color: #0497ca;
      color: white;
      border: none;
      cursor: pointer;
      border-radius:3px;
    }
    button:hover {
      background-color: #0497ca;
    }
  #postForm {
  flex: 1;
  max-width: 30%;
  margin-left:12%;
  box-sizing:border-box;
  background-color:#96d2ee;
  padding:15px;
  border-radius:3px;
  margin-top:1%
}

.top-section {
  display: flex;
  gap: 60px;
  margin-bottom: 40px;
}

.preview {
  flex:1;
  box-sizing:border-box;
  margin-left:10%;
  max-width: 30%;
  height:auto;
  border: 1.2px solid #ccc;
  border-radius: 8px;
  background-position: center;
  padding: 20px;
  color: white;
  background-color: #96d2ee;
  flex-direction: column;
  text-shadow: 2px 2px 4px #000;
  display: flex;
  justify-content: center;
  align-items: center;
}
.preview h2, .preview .date{
  margin: 5px 0;
}

@media (max-width: 768px) {
  .top-section {
    flex-direction: column;
    align-items: center;
  }
  #postForm{
    margin-top: 10%;
    max-width: 100%;
    margin-left: 0;
  }
  .preview {
    max-width: 100%;
    margin-left: 0;
  }
}

#postsList {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  padding:10px;
  margin-top: 20px;
  padding: 0 10px;
}

#postsList > div {
  border: 1px solid #ddd;
  padding: 15px;
  margin-bottom: 20px;
  width: 400px; 
  height: 300px; /* increased height for description */
  display:flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  background-color: #f9f9f9;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

#postsList > div img {
  max-width:300px;
  width: 100%;
  height: 100px;
  object-fit: cover;
  border-radius: 5px;
}

#postsList > div strong {
  font-size: 1.2rem;
  text-align: center;
  margin: 0;
}

#postsList > div small {
  font-size: 1rem;
  margin-bottom: 5px;
  text-align: center;
  color: #555;
}

#postsList > div p.description {
  display:none;
}

#postsList > div button {
  width: 90px;
  margin: 5px 0;
  padding: 8px 0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 600;
}

#postsList > div button:first-of-type {
  background-color: #0288d1;
  color: white;
}

#postsList > div button:last-of-type {
  background-color: #d32f2f;
  color: white;
}

  </style>
</head>
<body>
  <nav class="navbar">
        <div class="nav-logo">
            <a href="index.html"><img src="/photos/logo.png" alt="Cad Services Logo" width="30px" height="40px"></a>
            <a href="index.html"><img src="/photos/cad-services.png" alt="Cad Services Logo" width="220px" height="40px"></a>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="index.html" class="navlink">Home</a>
            <a href="services.html" class="navlink">Services</a>
            <a href="contact.html" class="navlink">Contact</a>
        </div>
        <div class="hamburger" id="hamburger">&#9776;</div>
    </nav>
    <script>
  const hamburger = document.getElementById('hamburger');
  const navLinks = document.getElementById('navLinks');
  hamburger.addEventListener('click', (e) => {
    e.stopPropagation();
    navLinks.classList.toggle('show');
  });
  navLinks.addEventListener('click', (e) => {
    e.stopPropagation();
  });
  document.addEventListener('click', () => {
    navLinks.classList.remove('show');
  });
</script>
<br><br><br><hr>
<div class="top-section">
  <form id="postForm" action="/add-post" method="POST" enctype="multipart/form-data">
    <label for="bgImage">Background Image:</label>
    <input type="file" id="bgImage" name="bgImage" accept="image/*" required />

    <label for="title">Post Title:</label>
    <input type="text" id="title" name="title" placeholder="Enter post title" required />

    <label for="date">Date:</label>
    <input type="date" id="date" name="date" required />

    <label for="description">Description:</label>
    <textarea type="description" id="description" name="description" placeholder="Enter post description" rows="3" required></textarea>

    <button type="submit">Add Post</button>
  </form>

  <div class="preview" id="postPreview" style="width:300px;height:250px;background:#eee;display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;">
    <h2 id="previewTitle">Post Title</h2>
    <div class="date" id="previewDate">DD-MM-YYYY</div>
  </div>
</div><hr><br>

<h1 style="text-align:center; background-color:white; border-radius:3px;">Recent Posts</h1><br><hr>
<div id="postsList"></div><br><hr><br>

<div id="overlay" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);z-index:100;"></div>
<div id="editModal" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);background:#fff;padding:20px;z-index:101;border-radius:6px;box-shadow:0 0 10px rgba(0,0,0,0.3);width:300px;">
  <h3>Edit Post</h3><br>
  <input type="text" id="editTitle" placeholder="Edit Title" style="width:100%;margin-bottom:10px;" />
  <input type="date" id="editDate" style="width:100%;margin-bottom:15px;" />
  <textarea id="editDescription" placeholder="Edit Description" style="width:100%;margin-bottom:15px;resize: vertical;" rows="3"></textarea>
  <button onclick="submitEdit()" style="margin-right:10px;">Save Changes</button>
  <button onclick="closeEditModal()">Cancel</button>
</div>

<script>
  let currentEditId = null;

  async function fetchPosts() {
    const res = await fetch('/get-posts');
    const posts = await res.json();

    // ✅ Sorting: latest date first
    posts.sort((a, b) => {
      const [da, ma, ya] = a.date.split('/');
      const [db, mb, yb] = b.date.split('/');
      const dateA = new Date(`20${ya}`, ma - 1, da);
      const dateB = new Date(`20${yb}`, mb - 1, db);
      return dateB - dateA;
    });

    const list = document.getElementById('postsList');
    list.innerHTML = '';

    posts.forEach(post => {
const div = document.createElement('div');
div.style.border = '1px solid #ddd';
div.style.padding = '15px';
div.style.marginBottom = '20px';
div.style.width = '400px';
div.style.backgroundColor = '#f9f9f9';
div.style.boxShadow = '0 2px 6px rgba(0,0,0,0.1)';
div.style.borderRadius = '8px';
div.style.display = 'flex';
div.style.flexDirection = 'column';
div.style.alignItems = 'center';
div.style.gap = '10px';

const img = document.createElement('img');
img.src = `/${post.bgImage}`;
img.alt = 'Post Image';
img.style.width = '150px';
img.style.height = '100px';
img.style.objectFit = 'cover';
img.style.borderRadius = '5px';

const title = document.createElement('strong');
title.textContent = post.title;
title.style.fontSize = '1.2rem';
title.style.textAlign = 'center';

const date = document.createElement('small');
date.textContent = post.date;
date.style.color = '#555';
date.style.fontSize = '1rem';
date.style.textAlign = 'center';

const description = document.createElement('p');
description.className = 'description';
description.textContent = post.description || '';

const btns = document.createElement('div');
btns.style.display = 'flex';
btns.style.justifyContent = 'center';
btns.style.padding = '5px';
btns.style.gap = '10px';
btns.style.width = '100%';

const editBtn = document.createElement('button');
editBtn.textContent = 'Edit';
editBtn.onclick = () => openEditModal(post.id, post.title, post.date, post.description);
editBtn.style.flex = '1';
editBtn.style.padding = '8px 0';
editBtn.style.backgroundColor = '#0288d1';
editBtn.style.color = 'white';
editBtn.style.border = 'none';
editBtn.style.borderRadius = '4px';
editBtn.style.cursor = 'pointer';
editBtn.style.fontWeight = '600';

const deleteBtn = document.createElement('button');
deleteBtn.textContent = 'Delete';
deleteBtn.onclick = () => deletePost(post.id);
deleteBtn.style.flex = '1';
deleteBtn.style.padding = '8px 0';
deleteBtn.style.backgroundColor = '#d32f2f';
deleteBtn.style.color = 'white';
deleteBtn.style.border = 'none';
deleteBtn.style.borderRadius = '4px';
deleteBtn.style.cursor = 'pointer';
deleteBtn.style.fontWeight = '600';

btns.appendChild(editBtn);
btns.appendChild(deleteBtn);

div.appendChild(img);
div.appendChild(title);
div.appendChild(date);
div.appendChild(description);
div.appendChild(btns);
list.appendChild(div);
    });
  }

  async function deletePost(id) {
    if (!confirm('Are you sure you want to delete this post?')) return;
    const res = await fetch(`/delete-post/${id}`, { method: 'DELETE' });
    const data = await res.json();
    if (data.success) {
      alert('Post deleted');
      fetchPosts();
    } else {
      alert('Delete failed');
    }
  }

  function openEditModal(id, title, date, description) {
    currentEditId = id;
    document.getElementById('editTitle').value = title;
    document.getElementById('editDescription').value = description || '';
    const parts = date.split('/');
    if(parts.length === 3) {
      const d = parts[0].padStart(2,'0');
      const m = parts[1].padStart(2,'0');
      let y = parts[2];
      if(y.length === 2) y = '20' + y;
      const formattedDate = `${y}-${m}-${d}`;
      document.getElementById('editDate').value = formattedDate;
    } else {
      document.getElementById('editDate').value = '';
    }
    document.getElementById('editModal').style.display = 'block';
    document.getElementById('overlay').style.display = 'block';
  }

  function closeEditModal() {
    document.getElementById('editModal').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
  }

  async function submitEdit() {
    const newTitle = document.getElementById('editTitle').value;
    const newDateRaw = document.getElementById('editDate').value;
    const newDescription = document.getElementById('editDescription').value;
    if (!newTitle || !newDateRaw || !newDescription) {
      alert('Title, Date, and Description cannot be empty!');
      return;
    }
    const d = new Date(newDateRaw);
    const day = String(d.getDate()).padStart(2,'0');
    const month = String(d.getMonth() + 1).padStart(2,'0');
    const year = String(d.getFullYear()).slice(-2);
    const newDate = `${day}/${month}/${year}`;

    const res = await fetch('/edit-post', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ id: currentEditId, title: newTitle, date: newDate, description: newDescription })
    });
    const data = await res.json();
    if(data.message === 'Post updated successfully') {
      alert('Post updated!');
      closeEditModal();
      fetchPosts();
    } else {
      alert('Update failed');
    }
  }

  fetchPosts();

  const titleInput = document.getElementById('title');
  const dateInput = document.getElementById('date');
  const bgInput = document.getElementById('bgImage');
  const descriptionInput = document.getElementById('description');
  const previewBox = document.getElementById('postPreview');
  const previewTitle = document.getElementById('previewTitle');
  const previewDate = document.getElementById('previewDate');
  const previewDescription = document.getElementById('previewDescription');

  titleInput.addEventListener('input', () => {
    previewTitle.textContent = titleInput.value || 'Post Title';
  });

  dateInput.addEventListener('input', () => {
    previewDate.textContent = dateInput.value || 'DD-MM-YYYY';
  });

  descriptionInput.addEventListener('input', () => {
    previewDescription.textContent = descriptionInput.value || 'Description preview here...';
  });

  bgInput.addEventListener('change', () => {
    const file = bgInput.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        previewBox.style.backgroundImage = `url('${e.target.result}')`;
        previewBox.style.backgroundSize = 'cover';
      };
      reader.readAsDataURL(file);
    }
  });
</script>

</body>
<footer>
    <div class="footer"><div class="footer-logo">
      <img src="/photos/cad-services.png" alt="Cad Services Logo" width="220px" height="40px">
      </div>
      <div class="footerinfoandlinks">
      <div class="footer-info">
      <hr style="margin-bottom:5px;">
      <h3>At CAD Services, we combine advanced technologies with industry experience to deliver results that meet the highest standards of 
        quality and efficiency. Whether it's topographic surveys, land development planning, contour mapping, or CAD drafting, our team is 
        dedicated to turning complex data into clear, actionable insights.</h3>
      </div>
      <div class="footer-links">
        <hr style="margin-bottom:5px;">
      <nav>
        <h3>SERVICES</h3><br>
        <h3> • Bridge Survey</h3>
        <h3> • Land Survey</h3>
        <h3> • Road Survey</h3>
        <h3> • Survey by Total Station</h3>
        <h3> • Survey by DGPS</h3>
        <h3> • Layout Work</h3>
        <h3> • Center Line Marking</h3>
        <h3> • Training Program</h3>
      </nav><br><br><br>
        <hr style="margin-bottom:5px;">
        <div class="social-links">
        <a href="https://www.facebook.com/p/CAD-Services-100066734150274/" target="_blank"><img src="/photos/fb.png" alt="Facebook" width="25px" height="25px"></a>
        <a href="https://www.instagram.com/cad.services_indore/" target="_blank"><img src="/photos/ig.png" alt="Instagram" width="25px" height="25px"></a>
        <h6 style="margin-top:2%;">&copy; 2025 by CAD Services</h6>  
      </div>
    </div>
    <div class="footer-address">
      <hr style="margin-bottom:5px;">
      <h3>LOCATED AT</h3><br>
      <h3>205, Gold Arcade, 3/1, Janjeerwala Square, New Palasia, Indore, Madhya Pradesh (452001)</h3><br><br><hr style="margin-bottom:5px;">
      <h3>CONTACT US</h3><br>
      <h3>+91 9826773808,<br>+91 9425073808</h3>
      <h6>cadservices2000@gmail.com</h6>
    </div>
    </div>
  </footer>
</html>
</html>

